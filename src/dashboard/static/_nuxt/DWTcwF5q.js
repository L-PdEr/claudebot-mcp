import{d as x,y as d,z as u,A as s,B as r,F as D,G as a,k as y,H as G,I as A,J as O,K as B,L as T,M as K,D as L,T as W,q as F,g as k,o as Q,N as X,C as b}from"./h6C6ZyYT.js";import{_ as C}from"./DlAUqK2U.js";const Y={class:"header"},Z={class:"header__content container"},ss={class:"header__brand"},es={class:"header__version"},ts={class:"header__actions"},as={class:"status-badge"},ns=x({__name:"AppHeader",props:{status:{default:"disconnected"},version:{default:"0.1.0"}},setup(n){const l=n,o=y(()=>{switch(l.status){case"connected":return"Connected";case"connecting":return"Connecting...";case"error":return"Error";default:return"Disconnected"}}),_=y(()=>{switch(l.status){case"connected":return"status-badge__dot--online";case"connecting":return"status-badge__dot--degraded";default:return"status-badge__dot--offline"}});return(e,i)=>(d(),u("header",Y,[s("div",Z,[s("div",ss,[i[1]||(i[1]=s("span",{class:"header__logo"},"ðŸ¤–",-1)),i[2]||(i[2]=s("span",{class:"header__title"},"ClaudeBot",-1)),s("span",es,"v"+r(n.version),1)]),s("div",ts,[s("div",as,[s("span",{class:D(["status-badge__dot",a(_)])},null,2),s("span",null,r(a(o)),1)]),s("button",{class:"btn btn--ghost btn--sm",onClick:i[0]||(i[0]=c=>e.$emit("refresh"))}," ðŸ”„ ")])])]))}}),os=C(ns,[["__scopeId","data-v-f21ee0ff"]]),ls={class:"card card--glow"},is={class:"card__header"},rs={class:"card__title"},cs={class:"card__icon"},ds={class:"card__body"},_s={key:0,class:"skeleton-container"},us=x({__name:"StatCard",props:{title:{},icon:{default:"ðŸ“Š"},loading:{type:Boolean,default:!1}},setup(n){return(l,o)=>(d(),u("div",ls,[s("div",is,[s("span",rs,r(n.title),1),s("span",cs,r(n.icon),1)]),s("div",ds,[n.loading?(d(),u("div",_s,[...o[0]||(o[0]=[s("div",{class:"skeleton",style:{height:"48px",width:"120px","margin-bottom":"8px"}},null,-1),s("div",{class:"skeleton",style:{height:"16px",width:"80px"}},null,-1)])])):G(l.$slots,"default",{key:1},void 0)])]))}}),gs=C(us,[["__scopeId","data-v-d1182973"]]),vs={class:"metric-bar"},ms={class:"progress__header"},hs={class:"metric-bar__label"},ps={class:"metric-bar__value"},fs={class:"progress__track"},bs=x({__name:"MetricBar",props:{label:{},value:{},percent:{},variant:{default:"default"}},setup(n){const l=n,o=y(()=>l.variant!=="default"?`progress__fill--${l.variant}`:l.percent>=90?"progress__fill--error":l.percent>=75?"progress__fill--warning":"");return(_,e)=>(d(),u("div",vs,[s("div",ms,[s("span",hs,r(n.label),1),s("span",ps,r(n.value),1)]),s("div",fs,[s("div",{class:D(["progress__fill",a(o)]),style:A({width:`${Math.min(n.percent,100)}%`})},null,6)])]))}}),ys=C(bs,[["__scopeId","data-v-c7f25fab"]]),$s={class:"status-row"},ws={class:"status-row__label"},ks={class:"status-row__status"},Ss={key:0,class:"status-row__detail"},xs={class:"status-badge"},Cs={class:"status-badge__text"},Ls=x({__name:"StatusRow",props:{label:{},status:{},detail:{default:""}},setup(n){const l=n,o=y(()=>`status-badge__dot--${l.status}`),_=y(()=>{switch(l.status){case"online":return"Online";case"degraded":return"Degraded";case"offline":return"Offline";default:return"Unknown"}});return(e,i)=>(d(),u("div",$s,[s("span",ws,r(n.label),1),s("div",ks,[n.detail?(d(),u("span",Ss,r(n.detail),1)):O("",!0),s("div",xs,[s("span",{class:D(["status-badge__dot",a(o)])},null,2),s("span",Cs,r(a(_)),1)])])]))}}),Ms=C(Ls,[["__scopeId","data-v-42f037f4"]]),Es={class:"message-list"},Bs={key:0,class:"message-list__loading"},Ts={key:1,class:"message-list__empty"},Ds={class:"message__header"},Rs={class:"message__user"},Hs={class:"message__time"},Is={class:"message__content"},Ns=x({__name:"MessageList",props:{messages:{},loading:{type:Boolean,default:!1}},setup(n){function l(o){return new Date(o).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}return(o,_)=>(d(),u("div",Es,[n.loading?(d(),u("div",Bs,[(d(),u(B,null,T(5,e=>s("div",{key:e,class:"skeleton message-list__skeleton"})),64))])):n.messages.length===0?(d(),u("div",Ts,[..._[0]||(_[0]=[s("span",{class:"message-list__empty-icon"},"ðŸ’¬",-1),s("span",{class:"message-list__empty-text"},"No messages yet",-1)])])):(d(),K(W,{key:2,name:"message",tag:"div",class:"message-list__items"},{default:L(()=>[(d(!0),u(B,null,T(n.messages,e=>(d(),u("div",{key:e.id,class:"message"},[s("div",Ds,[_[1]||(_[1]=s("span",{class:"message__icon"},"ðŸ“¨",-1)),s("span",Rs,r(e.user),1),s("span",Hs,r(l(e.timestamp)),1)]),s("div",Is,r(e.content),1)]))),128))]),_:1}))]))}}),Us=C(Ns,[["__scopeId","data-v-ede191bf"]]),As={key:0,class:"log-viewer__loading"},Os={key:1,class:"log-viewer__empty"},Fs={key:2,class:"log-viewer__content"},Ps={class:"log__time"},Vs={class:"log__icon"},Js={class:"log__level"},js={class:"log__message"},zs=x({__name:"LogViewer",props:{logs:{},loading:{type:Boolean,default:!1},maxHeight:{default:"300px"}},setup(n){function l(e){return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}function o(e){return`log--${e.toLowerCase()}`}function _(e){switch(e.toLowerCase()){case"error":return"ðŸ”´";case"warn":return"ðŸŸ¡";case"info":return"ðŸ”µ";case"debug":return"âšª";default:return"âš«"}}return(e,i)=>(d(),u("div",{class:"log-viewer",style:A({maxHeight:n.maxHeight})},[n.loading?(d(),u("div",As,[(d(),u(B,null,T(8,c=>s("div",{key:c,class:"skeleton log-viewer__skeleton"})),64))])):n.logs.length===0?(d(),u("div",Os,[...i[0]||(i[0]=[s("span",null,"No logs available",-1)])])):(d(),u("div",Fs,[(d(!0),u(B,null,T(n.logs,(c,$)=>(d(),u("div",{key:`${c.timestamp}-${$}`,class:D(["log",o(c.level)])},[s("span",Ps,r(l(c.timestamp)),1),s("span",Vs,r(_(c.level)),1),s("span",Js,r(c.level),1),s("span",js,r(c.message),1)],2))),128))]))],4))}}),qs=C(zs,[["__scopeId","data-v-54eb42ce"]]);function Gs(){const l=F().public.apiBase;async function o($,g){const m=await fetch(`${l}${$}`,{headers:{"Content-Type":"application/json",...g?.headers},...g});if(!m.ok){const S=await m.json().catch(()=>({error:"UNKNOWN_ERROR",message:`HTTP ${m.status}`}));throw new Error(S.message||"Request failed")}return m.json()}async function _(){return o("/api/health")}async function e(){return o("/api/status")}async function i(){return o("/api/metrics")}async function c($=20,g=0){return o(`/api/conversations?limit=${$}&offset=${g}`)}return{getHealth:_,getStatus:e,getMetrics:i,getConversations:c,fetchApi:o}}function Ks(){const l=F().public.apiBase,o=k("disconnected"),_=k(null);let e=null,i=null,c=null;function $(w,h){return e=new EventSource(`${l}/api/stream/metrics`),e.addEventListener("metrics",v=>{try{const f=JSON.parse(v.data);w(f),o.value="connected"}catch(f){console.error("Failed to parse metrics:",f)}}),e.addEventListener("heartbeat",()=>{_.value=new Date,o.value="connected"}),e.onerror=v=>{o.value="error",h?.(v)},e.onopen=()=>{o.value="connected"},e}function g(w,h){return i=new EventSource(`${l}/api/stream/messages`),i.addEventListener("message",v=>{try{const f=JSON.parse(v.data);w(f)}catch(f){console.error("Failed to parse message:",f)}}),i.addEventListener("heartbeat",()=>{_.value=new Date}),i.addEventListener("warning",v=>{console.warn("Messages stream warning:",v.data)}),i.onerror=v=>{h?.(v)},i}function m(w,h){return c=new EventSource(`${l}/api/stream/logs`),c.addEventListener("log",v=>{try{const f=JSON.parse(v.data);w(f)}catch(f){console.error("Failed to parse log:",f)}}),c.addEventListener("heartbeat",()=>{_.value=new Date}),c.addEventListener("warning",v=>{console.warn("Logs stream warning:",v.data)}),c.onerror=v=>{h?.(v)},c}function S(){e?.close(),i?.close(),c?.close(),e=null,i=null,c=null,o.value="disconnected"}return{status:o,lastHeartbeat:_,connectMetrics:$,connectMessages:g,connectLogs:m,disconnectAll:S}}const Ws={class:"dashboard"},Qs={class:"dashboard__main container"},Xs={key:0,class:"alert alert--error"},Ys={class:"dashboard__section"},Zs={class:"stats-grid"},se={class:"stat-value"},ee={class:"stat-value"},te={class:"stat-value"},ae={class:"stat-value"},ne={class:"dashboard__section"},oe={class:"card card--glow"},le={class:"card__body"},ie={class:"dashboard__columns"},re={class:"dashboard__section"},ce={class:"card"},de={class:"card__body"},_e={class:"dashboard__section"},ue={class:"card card--glow"},ge={class:"card__body cost-display"},ve={class:"cost-display__amount"},me={class:"dashboard__columns"},he={class:"dashboard__section"},pe={class:"card"},fe={class:"card__body"},be={class:"dashboard__section"},ye={class:"card"},$e={class:"card__body card__body--flush"},we={class:"dashboard__footer"},ke={class:"container"},Se=x({__name:"index",setup(n){const{getStatus:l,getHealth:o}=Gs(),{status:_,connectMetrics:e,connectMessages:i,connectLogs:c,disconnectAll:$}=Ks(),g=k(null),m=k(null),S=k([]),w=k([]),h=k(!0),v=k(null),f=y(()=>{if(!g.value)return"â€”";const p=g.value.uptime_secs,t=Math.floor(p/3600),M=Math.floor(p%3600/60);return t>0?`${t}h ${M}m`:`${M}m`}),P=y(()=>g.value?`${g.value.memory_mb} MB`:"â€”"),V=y(()=>g.value?Math.min(Math.round(g.value.memory_mb/512*100),100):0),H=y(()=>m.value?Math.round(m.value.cache_hit_rate):0),J=y(()=>g.value?g.value.bot_status==="running"?"online":"offline":"unknown"),j=y(()=>{if(!g.value)return"unknown";switch(g.value.api_status){case"ok":return"online";case"degraded":return"degraded";default:return"offline"}});async function I(){h.value=!0,v.value=null;try{const[p]=await Promise.all([l(),o()]);g.value=p}catch(p){v.value=p instanceof Error?p.message:"Failed to load data"}finally{h.value=!1}}function N(){I()}return Q(()=>{I(),e(p=>{m.value=p}),i(p=>{S.value=[p,...S.value.slice(0,49)]}),c(p=>{w.value=[p,...w.value.slice(0,99)]})}),X(()=>{$()}),(p,t)=>{const M=os,E=gs,U=ys,R=Ms,z=Us,q=qs;return d(),u("div",Ws,[b(M,{status:a(_),version:a(g)?.version||"0.1.0",onRefresh:N},null,8,["status","version"]),s("main",Qs,[a(v)?(d(),u("div",Xs,[s("span",null,r(a(v)),1),s("button",{class:"btn btn--ghost btn--sm",onClick:N}," Retry ")])):O("",!0),s("section",Ys,[t[4]||(t[4]=s("h2",{class:"section-title"},"System Overview",-1)),s("div",Zs,[b(E,{title:"Messages Today",icon:"ðŸ’¬",loading:a(h)},{default:L(()=>[s("div",se,r(a(m)?.messages_today||0),1),t[0]||(t[0]=s("div",{class:"stat-label"},"Processed today",-1))]),_:1},8,["loading"]),b(E,{title:"Active Users",icon:"ðŸ‘¥",loading:a(h)},{default:L(()=>[s("div",ee,r(a(m)?.active_users||0),1),t[1]||(t[1]=s("div",{class:"stat-label"},"Currently active",-1))]),_:1},8,["loading"]),b(E,{title:"Uptime",icon:"â±ï¸",loading:a(h)},{default:L(()=>[s("div",te,r(a(f)),1),t[2]||(t[2]=s("div",{class:"stat-label"},"Since restart",-1))]),_:1},8,["loading"]),b(E,{title:"Tokens Today",icon:"ðŸ”¤",loading:a(h)},{default:L(()=>[s("div",ae,r(a(m)?.tokens_today?.toLocaleString()||0),1),t[3]||(t[3]=s("div",{class:"stat-label"},"Used today",-1))]),_:1},8,["loading"])])]),s("section",ne,[t[5]||(t[5]=s("h2",{class:"section-title"},"Resources",-1)),s("div",oe,[s("div",le,[b(U,{label:"Memory",value:a(P),percent:a(V)},null,8,["value","percent"]),b(U,{label:"Cache Hit Rate",value:`${a(H)}%`,percent:a(H),variant:"success"},null,8,["value","percent"])])])]),s("div",ie,[s("section",re,[t[6]||(t[6]=s("h2",{class:"section-title"},"Services",-1)),s("div",ce,[s("div",de,[b(R,{label:"Telegram Bot",status:a(J)},null,8,["status"]),b(R,{label:"API Server",status:a(j)},null,8,["status"]),b(R,{label:"Dashboard",status:"online"})])])]),s("section",_e,[t[8]||(t[8]=s("h2",{class:"section-title"},"Usage Cost",-1)),s("div",ue,[s("div",ge,[s("div",ve," $"+r(a(m)?.cost_today_usd?.toFixed(4)||"0.0000"),1),t[7]||(t[7]=s("div",{class:"cost-display__label"},"Today's API cost",-1))])])])]),s("div",me,[s("section",he,[t[9]||(t[9]=s("h2",{class:"section-title"},"Recent Messages",-1)),s("div",pe,[s("div",fe,[b(z,{messages:a(S),loading:a(h)},null,8,["messages","loading"])])])]),s("section",be,[t[10]||(t[10]=s("h2",{class:"section-title"},"Logs",-1)),s("div",ye,[s("div",$e,[b(q,{logs:a(w),loading:a(h),"max-height":"400px"},null,8,["logs","loading"])])])])])]),s("footer",we,[s("div",ke,[t[11]||(t[11]=s("span",null,"ClaudeBot Dashboard",-1)),t[12]||(t[12]=s("span",{class:"dashboard__footer-dot"},"â€¢",-1)),s("span",null,r(a(g)?.version||"v0.1.0"),1)])])])}}}),Le=C(Se,[["__scopeId","data-v-6145efb6"]]);export{Le as default};
